
<div class="container mx-auto my-12 mt-20">


    <div class="container mx-auto p-8">

        <div class="container mx-auto p-8">
    <h1 class="text-3xl font-bold mb-6">Generar Reporte Excel</h1>
    <form class="bg-white p-4 rounded shadow-md">
        <!--Agregar campos de base de datos-->
      <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
        <div class="mb-4">
          <label class="block font-medium mb-2">
            <input type="checkbox" name="id_agencia" class="mr-2">
            AGENCIA
          </label>
        </div>

        <div class="mb-4">
          <label class="block font-medium mb-2">
            <input type="checkbox" name="nombre" class="mr-2">
            NOMBRE
          </label>
        </div>

        <div class="mb-4">
          <label class="block font-medium mb-2">
            <input type="checkbox" name="departamento" class="mr-2">
            DEPARTAMENTO
          </label>
        </div>

        <div class="mb-4">
          <label class="block font-medium mb-2">
            <input type="checkbox" name="correo" class="mr-2">
            CORREO
          </label>
        </div>

        <div class="mb-4">
          <label class="block font-medium mb-2">
            <input type="checkbox" name="serie" class="mr-2">
            SERIE
          </label>
        </div>

        <div class="mb-4">
          <label class="block font-medium mb-2">
            <input type="checkbox" name="cpu" class="mr-2">
            CPU
          </label>
        </div>

        <div class="mb-4">
          <label class="block font-medium mb-2">
            <input type="checkbox" name="ram" class="mr-2">
            RAM
          </label>
        </div>

           <div class="mb-4">
          <label class="block font-medium mb-2">
            <input type="checkbox" name="disco_duro" class="mr-2">
            DISCO DURO
          </label>
        </div>

           <div class="mb-4">
          <label class="block font-medium mb-2">
            <input type="checkbox" name="monitor" class="mr-2">
            MONITOR
          </label>
        </div>

         <div class="mb-4">
          <label class="block font-medium mb-2">
            <input type="checkbox" name="teclado" class="mr-2">
            TECLADO
          </label>
        </div>

         <div class="mb-4">
          <label class="block font-medium mb-2">
            <input type="checkbox" name="mouse" class="mr-2">
            MOUSE
          </label>
        </div>

         <div class="mb-4">
          <label class="block font-medium mb-2">
            <input type="checkbox" name="tableta" class="mr-2">
            TABLETA
          </label>
        </div>

         <div class="mb-4">
          <label class="block font-medium mb-2">
            <input type="checkbox" name="adaptador" class="mr-2">
            ADAPTADOR
          </label>
        </div>

         <div class="mb-4">
          <label class="block font-medium mb-2">
            <input type="checkbox" name="so" class="mr-2">
            S/O
          </label>
        </div>

         <div class="mb-4">
          <label class="block font-medium mb-2">
            <input type="checkbox" name="licencia" class="mr-2">
            TIPO DE LICENCIA
          </label>
        </div>

         <div class="mb-4">
          <label class="block font-medium mb-2">
            <input type="checkbox" name="direccion_ip" class="mr-2">
            DIRECCIÓN IP
          </label>
        </div>

         <div class="mb-4">
          <label class="block font-medium mb-2">
            <input type="checkbox" name="direccion_ip_wifi" class="mr-2">
            DIRECCIÓN IP WIFI
          </label>
        </div>










        <!-- Agrega los otros campos de la misma manera -->
      </div>
      <!-- Agrega el botón para generar el informe -->
      <button type="submit" class="bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 mt-4 rounded-md focus:outline-none focus:shadow-outline">Generar Informe</button>
    </form>
  </div>
 

  </div>

  <!-- Agregar el script para generar el informe -->
  <script>
    function generateReport() {
      // Obtener los campos seleccionados
      const fields = Array.from(document.querySelectorAll('input[name="fields"]:checked')).map(input => input.value);

      // Validar que se hayan seleccionado campos
      if (fields.length === 0) {
        alert('Debes seleccionar al menos un campo para generar el informe.');
        return;
      }

      // Aquí debes hacer una petición al servidor para generar el informe Excel con los campos seleccionados.
      // Puedes utilizar fetch() para hacer una solicitud POST al servidor con los campos seleccionados.

      // Ejemplo de cómo hacer una solicitud POST con fetch (debes ajustar la URL y el cuerpo de la solicitud según tu backend):
      fetch('/ruta-al-servidor/generar-informe', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ fields: fields })
      })
      .then(response => {
        if (response.ok) {
          // Si la respuesta del servidor es exitosa, descarga el informe Excel
          return response.blob();
        } else {
          throw new Error('Hubo un error al generar el informe.');
        }
      })
      .then(blob => {
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'informe.xlsx'; // Nombre del archivo de descarga
        a.click();
        URL.revokeObjectURL(url);
      })
      .catch(error => {
        console.error(error);
        alert('Hubo un error al generar el informe.');
      });
    }
  </script>
 
</div>


